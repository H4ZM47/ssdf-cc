---
name: ssdf-vulnerability-response
description: Use when vulnerabilities are discovered or reported - guides systematic identification, assessment, remediation, and root cause analysis per SSDF RV.1-3. Dispatches error-detective and debugger agents.
---

# SSDF Vulnerability Response (RV.1-3)

## Overview

Systematic response to discovered vulnerabilities: identify, assess, remediate, and analyze root cause to prevent recurrence.

**SSDF References:**
- RV.1.1 (Gather Vulnerability Information)
- RV.1.2 (Review/Analyze/Test Code)
- RV.1.3 (Vulnerability Disclosure Policy)
- RV.2.1 (Analyze Risk)
- RV.2.2 (Plan and Implement Response)
- RV.3.1 (Determine Root Cause)
- RV.3.2 (Analyze Patterns)
- RV.3.3 (Review for Similar Issues)
- RV.3.4 (Update SDLC Process)

## When to Use

**Triggered by:**
- Security researcher report
- Automated scanning findings
- Penetration test results
- Production incident
- Dependency vulnerability disclosure
- Internal code review discovery

## Response Process

### Phase 1: Identification (RV.1)

**Step 1: Create Tracking Issue**
```bash
bd create "VULN: [Brief Description]" --type security -d "Source: [how discovered]. Initial severity: [estimate]"
```

**Step 2: Gather Information**

Dispatch `error-detective` agent:
```
Analyze the following vulnerability report:
[Include vulnerability details]

Determine:
1. Affected components and versions
2. Attack vector and prerequisites
3. Potential impact (confidentiality, integrity, availability)
4. Exploitability assessment
5. Scope of affected deployments
```

**Step 3: Document Initial Assessment**
```markdown
## Vulnerability: [ID]
**Reported:** [date]
**Source:** [how discovered]
**Affected:** [components/versions]
**Status:** Investigating
```

### Phase 2: Assessment (RV.2.1)

**Risk Scoring:**

| Factor | Score (1-10) | Notes |
|--------|--------------|-------|
| Exploitability | | How easy to exploit? |
| Impact | | What's the damage? |
| Affected Users | | How many impacted? |
| Data Sensitivity | | What data at risk? |
| **Overall Risk** | | Average or weighted |

**Severity Classification:**
- **Critical (9-10):** Immediate action, all hands
- **High (7-8):** Fix within 24-48 hours
- **Medium (4-6):** Fix within sprint/week
- **Low (1-3):** Backlog, fix when convenient

### Phase 3: Remediation (RV.2.2)

**Step 1: Develop Fix**

Dispatch `debugger` agent for complex issues:
```
Analyze the root cause of this vulnerability:
[Include vulnerability details and affected code]

Provide:
1. Exact root cause
2. Minimal fix approach
3. Potential side effects
4. Test cases to verify fix
```

**Step 2: Implement and Verify**

- [ ] Fix implemented
- [ ] Unit tests added for vulnerability
- [ ] Security review of fix (use ssdf-security-review)
- [ ] No regression in functionality
- [ ] Fix verified in staging environment

**Step 3: Deploy**

- [ ] Deployment plan documented
- [ ] Rollback plan ready
- [ ] Monitoring in place
- [ ] Stakeholders notified

### Phase 4: Root Cause Analysis (RV.3)

**Step 1: Determine Root Cause (RV.3.1)**

Answer:
- Why did this vulnerability exist?
- When was it introduced?
- Why wasn't it caught earlier?
- What process failed?

**Step 2: Pattern Analysis (RV.3.2)**

Check for patterns:
- Similar vulnerabilities in codebase?
- Same developer/team pattern?
- Same technology/framework issue?
- Gap in training or tooling?

Dispatch `code-reviewer` agent:
```
Search the codebase for similar patterns to this vulnerability:
[Include vulnerability pattern]

Find:
1. Similar code patterns
2. Same anti-pattern elsewhere
3. Related vulnerable code
```

**Step 3: Review for Similar Issues (RV.3.3)**

- [ ] Codebase searched for similar patterns
- [ ] Related issues identified and tracked
- [ ] Batch fix planned if multiple instances

**Step 4: Process Improvement (RV.3.4)**

Document lessons learned:
```markdown
## Lessons Learned: [VULN-ID]

### What Happened
[Brief description]

### Root Cause
[Why it happened]

### Why Not Caught
[Gap in process]

### Process Improvements
1. [Specific improvement]
2. [Tooling change]
3. [Training need]

### Implementation
- [ ] Improvement 1 implemented
- [ ] Improvement 2 implemented
- [ ] Team notified
```

## Evidence Documentation

Create comprehensive evidence file:
```
.claude/ssdf/evidence/vulnerabilities/YYYY-MM-DD-[vuln-id].md
```

**Required sections:**
1. Vulnerability summary
2. Timeline (discovery → fix → deploy)
3. Risk assessment
4. Technical analysis (agent outputs)
5. Remediation details
6. Root cause analysis
7. Process improvements
8. Sign-off

## Communication Templates

**Internal Notification:**
```markdown
## Security Vulnerability Identified

**Severity:** [Critical/High/Medium/Low]
**Affected:** [components]
**Status:** [Investigating/Fixing/Deployed]
**ETA:** [if known]

**Action Required:** [if any]
```

**External Disclosure (if applicable):**
```markdown
## Security Advisory: [ID]

**Product:** [name]
**Affected Versions:** [versions]
**Fixed Version:** [version]
**Severity:** [CVSS score if applicable]

**Description:**
[Non-exploitable description]

**Mitigation:**
[Steps to protect]

**Credit:**
[Reporter attribution if requested]
```

## Beads Integration

Track full lifecycle:
```bash
# Initial report
bd create "VULN: [description]" --type security

# Update status
bd update [id] --status in_progress

# Link to fix
bd update [id] -d "Fix in PR #123. Root cause: [summary]"

# Close with resolution
bd close [id] --reason "Fixed in v1.2.3. RCA complete. Process updated."
```

## Checklist: Vulnerability Response Complete

- [ ] Vulnerability identified and documented
- [ ] Risk assessed and severity assigned
- [ ] Fix developed and reviewed
- [ ] Fix deployed to all affected environments
- [ ] Root cause determined
- [ ] Similar issues searched and addressed
- [ ] Process improvements identified
- [ ] Lessons learned documented
- [ ] Evidence file complete
- [ ] Beads issue closed with resolution
- [ ] Stakeholders notified of resolution
